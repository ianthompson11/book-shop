{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Productos</title>

    <!-- Tailwind CSS desde CDN para estilos rápidos y profesionales -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Script de carrito con control de login y almacenamiento local -->
    <script src="{% static 'store/cart.js' %}"></script>
</head>

<!-- Agrega un atributo al <body> para saber si el usuario ha iniciado sesión (usado por cart.js) -->
<body class="bg-gray-100 font-sans" data-authenticated="{% if user.is_authenticated %}true{% else %}false{% endif %}">

    <!-- Incluye menú de navegación -->
    {% include 'store/navbar.html' %}

    <!-- Contenedor principal del contenido -->
    <div class="max-w-6xl mx-auto px-4 py-10">

        <!-- Título llamativo con ícono de carrito -->
        <h1 class="text-4xl font-bold text-center mb-10 text-gray-800">
            Tienda Bocaracá 🛒
        </h1>

        <!-- Contenedor de productos: grid responsive (1, 2 o 3 columnas) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">

            <!-- Iteración de cada producto enviado desde la vista Django -->
            {% for product in products %}

            <!-- Tarjeta de producto con sombra y padding -->
            <div class="bg-white shadow-md rounded-lg p-6 transition transform hover:scale-105 duration-300">

                <!-- Imagen del producto -->
                {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}"
                         class="w-full h-40 object-cover rounded mb-4">
                {% else %}
                    <div class="w-full h-40 bg-gray-200 rounded mb-4 flex items-center justify-center text-gray-500">
                        Sin imagen
                    </div>
                {% endif %}

                <!-- Nombre del producto -->
                <h2 class="text-xl font-semibold mb-2">{{ product.name }}</h2>

                <!-- Descripción breve -->
                <p class="text-gray-700 mb-2">{{ product.description }}</p>

                <!-- Precio destacado -->
                <p class="text-lg font-bold text-green-600 mb-4">${{ product.price }}</p>

                <!-- Botón para agregar producto al carrito -->
                <button
                    onclick="addToCart('{{ product.name }}', {{ product.price }}, '{{ product.description }}', '{{ product.sku }}')"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded w-full shadow">
                    Agregar al carrito
                </button>
            </div>

            {% endfor %}
        </div>

        <!-- Botón para confirmar carrito -->
        <div class="text-center mt-10">
            <button id="confirmar-carrito"
                    class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded text-lg shadow">
                Confirmar Pedido
            </button>
        </div>
    </div>

    <!-- Script para redirigir al resumen del carrito si el usuario hace clic -->
    <script>
        // Asocia el botón de confirmación con la redirección a /confirm-order/
        document.getElementById("confirmar-carrito").addEventListener("click", () => {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            if (cart.length === 0) {
                alert("Tu carrito está vacío.");
            } else {
                window.location.href = "/confirm-order/";
            }
        });
    </script>

</body>
</html>


